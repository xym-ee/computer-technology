---
sort: 4
---
# 并发控制：信号量

我们分析了同步的本质需求：两个并发的线程等待某个同步条件达成，完成时间线的 “交汇”。相应地，我们有了条件变量实现同步，并且解决了生产者-消费者问题 (括号打印问题)。

本讲内容：另一种共享内存系统中常用的同步方法：信号量 (E. W. Dijkstra)
- 什么是信号量
- 信号量适合解决什么问题
- 哲学家吃饭问题

## 什么是信号量

互斥锁每次只能让一个人进入。

完全没有必要，因为可以让更多的人一起进来。

这就有了一个更漂亮的机制：信号量。


```c
void producer() {
  P(&empty);   // P()返回 -> 得到手环
  printf("("); // 假设线程安全
  V(&fill);
}
void consumer() {
  P(&fill);
  printf(")");
  V(&empty);
}
```

有两个信号量。这个代码很漂亮。很干净。

整个这代码密度就要比前面的简单。在“一单位资源”很明确的情况下，确实很好用，也应该用。

## 信号量的应用

## 哲学家吃饭问题

遇到的问题：死锁。并发编程一定会遇到这个问题，幸运的是，这个 bug 是比较容易解决的。

